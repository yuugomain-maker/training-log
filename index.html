<!DOCTYPE html>
<html lang="ja">
<head>
    <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

  // --- あなたのFirebase設定をここに貼り付け ---
  const firebaseConfig = {
    apiKey: "AIzaSyDCNOp_Qk__5ClLSVCUwDUU6rtGKAnX2JU",
    authDomain: "training-log-27407.firebaseapp.com",
    projectId: "training-log-27407",
    storageBucket: "training-log-27407.firebasestorage.app",
    messagingSenderId: "996903584995",
    appId: "1:996903584995:web:09e63c9b6447b3952c71d6",
    measurementId: "G-LBHF20MC70"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // Firestore書き込み関数（使い方は下で説明）
  export async function saveLogToCloud(log) {
    try {
      await addDoc(collection(db, "trainingLogs"), log);
      console.log("Cloud保存成功:", log);
    } catch (e) {
      console.error("Cloud保存失敗:", e);
    }
  }

  // Firestore読み込み関数（全データを取得）
  export async function loadLogsFromCloud() {
    const querySnapshot = await getDocs(collection(db, "trainingLogs"));
    return querySnapshot.docs.map(doc => doc.data());
  }
</script>

  <meta charset="UTF-8">
  <title>トレーニングログ（試作版）</title>
  
</head>
<body>
  <h1>トレーニングログ（試作版）</h1>

  <!-- 入力フォーム -->
  <form id="log-form">
    <label>
      日付：
      <input type="date" id="date">
    </label>
    <br>

    <label>
      種目：
      <select id="exercise">
        <option value="">選択してください</option>
        <option value="ベンチプレス">ベンチプレス</option>
        <option value="スクワット">スクワット</option>
        <option value="デッドリフト">デッドリフト</option>
        <option value="オーバーヘッドプレス">オーバーヘッドプレス</option>
        <option value="ラットプルダウン">ラットプルダウン</option>
        <option value="シーテッドロウ">シーテッドロウ</option>
        <option value="インクラインダンベルプレス">インクラインダンベルプレス</option>
        <option value="ケーブルカール">ケーブルカール</option>
        <option value="ハンマーカール">ハンマーカール</option>
        <option value="レッグプレス">レッグプレス</option>
        <option value="レッグカール">レッグカール</option>
        <option value="レッグエクステンション">レッグエクステンション</option>
        <option value="その他">その他</option>
      </select>
    </label>
    <br>

    <label>
      セット番号：
      <input type="number" id="setNo" min="1" value="1">
    </label>
    <br>

    <label>
      重量(kg)：
      <input type="number" id="weight">
    </label>
    <br>

    <label>
      回数：
      <input type="number" id="reps">
    </label>
    <br>

    <label>
      RPE：
      <input type="number" id="rpe" step="0.5" min="5" max="10">
    </label>
    <br>

    <label>
      メモ：
      <input type="text" id="memo" placeholder="フォーム・体調など">
    </label>
    <br><br>

    <button type="submit">追加</button>
  </form>

  <h2>記録一覧</h2>
  <ul id="log-list"></ul>

  <h2>推定1RMグラフ</h2>
  <label for="exercise-select">種目を選択：</label>
  <select id="exercise-select">
    <option value="">記録がある種目から選択</option>
  </select>

  <label for="range-select">　期間：</label>
  <select id="range-select">
    <option value="all">全期間</option>
    <option value="30">直近30日</option>
    <option value="90">直近90日</option>
  </select>

  <br><br>
  <canvas id="rmChart" height="200"></canvas>

  <h2>統計</h2>
  <div id="stats"></div>

  <h2>種目別履歴（最近3回のトレーニング日）</h2>
  <div id="history"></div>

<!-- グラフ用ライブラリ Chart.js（これは通常のscriptでOK） -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- 自分のスクリプト：必ず module で -->
<script type="module" src="./app.js"></script>
</body>
</html>

